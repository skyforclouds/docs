---
title: 'Deploying Daemon Jobs'
description: 'Run background jobs on every node in your SoraNova cluster'
---

## What is a Daemon Job?

Daemon jobs are background services that run on every node in your SoraNova cluster. They are ideal for log shippers, monitoring agents, or any persistent process that should be present on all nodes.


---

## Example: Deploying a Log Shipping Daemon

Below is a sample configuration for deploying [Vector](https://vector.dev/) as a log shipper daemon. This will collect logs from `/var/log` and Docker, and can be configured to push them to an external HTTP endpoint.

```hcl
variable "custom_sink_uri" {
    type = string
}

application {
    name        = "Vector Log Daemon"
    summary     = "High-performance log collection and forwarding daemon that efficiently pushes logs to various sinks."
    description = "Vector is a lightweight, ultra-fast tool for building observability pipelines. It collects, transforms, and routes logs from multiple sources to various sinks with minimal resource overhead and maximum reliability."
    category    = "daemon"
    tags        = ["logging", "observability", "daemon"]

  daemon {
    name = "vector"

    config {
      image = "timberio/vector:latest-debian"

      volumes = [
        "/var/log:/var/log:ro"
      ]

      args = [
        "--config-dir", "/local/etc/vector"
      ]
    }

    template {
      data = <<EOF
[sources.my_source]
type = "file"
include = ["/var/log/**/*.log"]
fingerprint.strategy = "device_and_inode"

[sources.docker_logs]
type = "docker_logs"

[sinks.my_sink]
type = "http"
inputs = ["my_source", "docker_logs"]
uri = "${var.custom_sink_uri}"
encoding.codec = "json"

EOF

      destination = "/local/etc/vector/vector.toml"
    }

    resources {
      cpu_mhz    = 100
      memory_mib = 1024
    }
  }
}
```

---

## Key Points

- **Daemon jobs run on every node**: Use them for log collection, monitoring, or any background process.
- **Customizable sinks**: You can ship logs to an internal HTTP endpoint by editing the `template` block (see the commented section in the example).
- **Resource allocation**: Use the `resources` block to control CPU and memory usage.

---

## Deploying the Daemon

1. Save the above configuration to a file, e.g. `vector-daemon.hcl`.
2. Deploy it using the SoraNova CLI:

    ```bash
    sora recipe seed vector-daemon.hcl
    sora recipe list
    sora recipe deploy <recipe-slug>
    ```

3. The daemon will now run on every node in your cluster.

---

ðŸŽ‰ That's it! You now have a background daemon running on every node in your SoraNova cluster.
